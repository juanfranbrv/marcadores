<aside id="sidebar-raindrop" class="w-64 border-r bg-gray-50 p-4 hidden md:block">
  <div id="sidebar-content"></div>
</aside>

<script type="module">
const sidebarContent = document.getElementById('sidebar-content');

async function renderSidebar() {
  if (!sidebarContent) return;
  sidebarContent.innerHTML = '<div class="text-center py-10">Cargando categorías y etiquetas...</div>';
  try {
    const [collectionsRes, tagsRes] = await Promise.all([
      fetch('/api/raindrop/collections'),
      fetch('/api/raindrop/tags')
    ]);
    const collections = [{ _id: 0, title: 'Todas' }, ...((await collectionsRes.json()) || [])];
    const tags = ['Todas', ...((await tagsRes.json()) || [])];
    sidebarContent.innerHTML = `
      <div class="space-y-6">
        <div>
          <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">PRODUCT CATEGORIES</h3>
          <div class="space-y-1">
            ${collections.map(col => `
              <a href="${col._id === 0 ? '/' : `/category/${col._id}` }" class="flex items-center gap-2 w-full px-3 py-2 text-sm font-medium rounded-md ${window.location.pathname === `/category/${col._id}` || (col._id === 0 && window.location.pathname === '/') ? 'bg-indigo-600 text-white' : 'text-gray-700 hover:bg-gray-200'}">
                <span class="text-gray-400">#</span> ${col.title}
              </a>
            `).join('')}
          </div>
        </div>
        <div>
          <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">TAGS</h3>
          <div class="flex flex-wrap gap-2">
            ${tags.map(tag => `
              <a href="${tag === 'Todas' ? '/' : `/tag/${encodeURIComponent(tag)}` }" class="px-2 py-1 rounded-md text-xs font-medium ${window.location.pathname === `/tag/${encodeURIComponent(tag)}` || (tag === 'Todas' && window.location.pathname === '/') ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                #${tag.replace(/\s+/g, '')}
              </a>
            `).join('')}
          </div>
        </div>
      </div>
    `;
  } catch (e) {
    sidebarContent.innerHTML = '<div class="text-red-500 text-center mt-10">Error al cargar categorías o etiquetas</div>';
  }
}

renderSidebar();
</script>
